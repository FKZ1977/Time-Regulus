<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>Time Regulus</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="style.css">
  <link rel="manifest" href="manifest.json">
</head>
<body>
  <!-- 🔐 ロック画面 -->
  <div id="lockScreen">
    <h1 class="fkz">Time Regulus</h1>
    <p class="subtitle">タイム　レグルス</p>
    <label for="passcode">暗証番号を入力：</label><br>
    <input type="password" id="passcode" placeholder="例：1234" tabindex="1">
    <button class="action-btn" onclick="checkPass()" tabindex="2">開く</button>
    <p id="error" style="color:red;"></p><br>
    <p class="subtitle">- produced by H.Fukazu -</p>
  </div>

  <!-- 🔁 モード選択画面 -->
  <div id="modeSelect" style="display:none; text-align:center;">
    <h1 class="fkz">Time Regulus</h1>
    <p class="subtitle">- モード選択 -</p>
    <div style="display: flex; flex-direction: column; align-items: center; gap: 20px; margin-top: 40px;">
      <button class="action-btn" onclick="showErrorMode()" tabindex="3">誤差の計算</button>
      <button class="action-btn" onclick="showCorrectionMode()" tabindex="4">補正時刻の計算</button>
    </div>
  </div>

  <!-- 🧮 誤差計算モード -->
  <div id="errorMode" class="mode-card" style="display:none;">
    <button class="back-btn" onclick="backToModeSelect()" tabindex="5">← モード選択に戻る</button>
    <p class="subtitle">誤差時刻の計算</p>

    <div class="input-group">
      <label for="standardTime">標準時刻:</label><br>
      <input type="datetime-local" id="standardTime" step="60" tabindex="6">
      <select id="standardSeconds" class="seconds-select" tabindex="7">
        <option value="">秒</option>
      </select>
    </div>

    <div class="input-group">
      <label for="displayTime">表示時刻:</label><br>
      <input type="datetime-local" id="displayTime" step="60" tabindex="8">
      <select id="displaySeconds" class="seconds-select" tabindex="9">
        <option value="">秒</option>
      </select>
    </div>

    <button class="action-btn" onclick="calculateError()" tabindex="10">誤差時間を計算</button>

    <div id="result" class="result-box"></div>

    <div id="correctionPreview">
      <div id="correctionResult"></div>
      <div id="toReverseButton" style="display: none; margin-top: 20px;">
        <button class="action-btn" onclick="switchToCorrectionMode()" tabindex="11">この誤差で逆算する</button>
      </div>
    </div>
  </div>

  <!-- 🔧 補正モード -->
  <div id="correctionMode" class="mode-card deep-green" style="display:none;">
    <button class="back-btn" onclick="backToModeSelect()" tabindex="12">← モード選択に戻る</button>
    <p class="subtitle">補正時刻の計算</p>

    <label>補正に使う誤差：</label>
    <div class="flex-wrap">
      <div class="unit-input">
        <input type="number" id="errorDays" min="0" step="1" oninput="reverseCalculate()" tabindex="13">
        <span class="unit-label">日</span>
      </div>
      <div class="unit-input">
        <input type="number" id="errorHours" min="0" max="23" step="1" oninput="reverseCalculate()" tabindex="14">
        <span class="unit-label">時</span>
      </div>
      <div class="unit-input">
        <input type="number" id="errorMinutes" min="0" max="59" step="1" oninput="reverseCalculate()" tabindex="15">
        <span class="unit-label">分</span>
      </div>
      <div class="unit-input">
        <input type="number" id="errorSeconds" min="0" max="59" step="1" oninput="reverseCalculate()" tabindex="16">
        <span class="unit-label">秒</span>
      </div>
    </div>

    <div class="input-group">
      <label for="errorDirection" style="display:inline-block;">表示時刻は標準時刻より：</label>
      <select id="errorDirection" onchange="reverseCalculate()" tabindex="17">
        <option value="late">進んでいる</option>
        <option value="early">遅れている</option>
      </select>
    </div>

    <div class="input-group">
      <label for="reverseDisplayTime">表示時刻:</label><br>
      <input type="datetime-local" id="reverseDisplayTime" step="60" tabindex="18">
      <select id="reverseDisplaySeconds" class="seconds-select" tabindex="19">
        <option value="">秒</option>
      </select>
    </div>

    <button class="action-btn" onclick="reverseCalculate()" tabindex="20">補正時刻を計算</button>

    <div id="reverseResult" class="result-box"></div>
  </div>

  <script src="script.js" defer></script>
  <script>
    if ("serviceWorker" in navigator) {
      navigator.serviceWorker.register("service-worker.js")
        .then(() => console.log("Service Worker registered"))
        .catch(error => console.error("Service Worker registration failed:", error));
    }
  </script>
</body>
</html>