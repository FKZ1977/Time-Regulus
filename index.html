<!DOCTYPE html>
<html lang="ja">
<head>
  <!-- meta charset="UTF-8" -->
  <title>Time Regulus</title>

  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-R7PW7DY4GF"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-R7PW7DY4GF');
  </script>

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="manifest" href="manifest.json">
  <link rel="apple-touch-icon" href="icon-192.png">
  <link rel="stylesheet" href="style.css">

  <style>
    @keyframes riseInLong {
      0% { opacity: 0; transform: translateY(20px); }
      100% { opacity: 1; transform: translateY(0); }
    }
    @keyframes riseInShort {
      0% { opacity: 0; transform: translateY(20px); }
      100% { opacity: 1; transform: translateY(0); }
    }
    .rise-in-long { animation: riseInLong 1s ease-out forwards; }
    .rise-in-short { animation: riseInShort 1s ease-out forwards; }
  </style>
</head>
<body class="fade-in">
  <!-- 🔐 ロック画面 -->
  <div id="lockScreen">
    <h1 class="fkz rise-in-long">Time Regulus</h1>
    <p class="subtitle">タイム　レグルス　v1.5.1</p>
    <label for="passcode">暗証番号を入力：</label><br>
    <input type="password" id="passcode" placeholder="例：1234" tabindex="1">
    <button class="action-btn" onclick="checkPass()" tabindex="2">開く</button>

    <!-- 🎲 ランダムテンキー -->
    <div id="keypad" class="keypad-grid"></div>

    <!-- ✅ エラー表示（高さ固定） -->
    <p id="error"></p>
    <p class="subtitle">- produced by H.Fukazu -</p>

    <p class="info-link" onclick="showInformationPage()"> - information - </p>

  </div>

  <!-- 🔁 モード選択画面 -->
  <div id="modeSelect" style="display:none; text-align:center;">
    <h1 class="fkz rise-in-short">Time Regulus</h1>
    <p class="subtitle">- モード選択 -</p>
    <div style="display: flex; flex-direction: column; align-items: center; gap: 20px; margin-top: 40px;">
      <button class="action-btn" onclick="showErrorMode()" tabindex="3">誤差の計算</button>
      <button class="action-btn" onclick="showCorrectionMode()" tabindex="4">補正時刻の計算</button>
    </div>
  </div>

  <!-- 🧮 誤差計算モード -->
  <div id="errorMode" style="display:none;">
    <div class="mode-card">
      <button class="back-btn" onclick="backToModeSelect()">← モード選択に戻る</button>
      <h2>誤差の計算</h2>

      <div class="input-group">
        <label>表示時刻：</label><br>
        <input type="datetime-local" id="displayTime">
        <select id="displaySeconds" class="seconds-select">
          <option value="">秒</option>
        </select>
      </div>

      <div class="input-group">
        <label>標準時刻：</label>
        <button class="action-btn" onclick="setNowToStandard()" style="margin-left: 8px;">NOW🔄</button><br>
        <input type="datetime-local" id="standardTime">
        <select id="standardSeconds" class="seconds-select">
          <option value="">秒</option>
        </select>
      </div>

      <button class="action-btn" onclick="calculateError()">誤差を計算</button>
      <div class="result-box" id="result"></div>
      <button class="action-btn" id="toReverseButton" onclick="switchToCorrectionMode()" style="display:none;">⇆ 補正時刻を計算</button>
    </div>
  </div>

  <!-- 🔧 補正モード（逆算） -->
  <div id="correctionMode" class="mode-card deep-green" style="display:none;">
    <button class="back-btn" onclick="backToModeSelect()" tabindex="12">← モード選択に戻る</button>
    <h2>補正時刻の計算</h2>
    <label>補正に使う誤差：</label>
    <div class="flex-wrap">
      <div class="unit-input">
        <input type="number" id="errorDays" min="0" step="1" tabindex="13">
        <span class="unit-label">日</span>
      </div>
      <div class="unit-input">
        <select id="errorHours" tabindex="14">
          <option value="">--</option>
        </select>
        <span class="unit-label">時</span>
      </div>
      <div class="unit-input">
        <select id="errorMinutes" tabindex="15">
          <option value="">--</option>
        </select>
        <span class="unit-label">分</span>
      </div>
      <div class="unit-input">
        <select id="errorSeconds" tabindex="16">
          <option value="">--</option>
        </select>
        <span class="unit-label">秒</span>
      </div>
    </div>

    <div class="input-group">
      <label for="errorDirection" style="display:inline-block;">表示時刻は標準時刻より：</label>
      <select id="errorDirection" tabindex="17">
        <option value="late">進んでいる</option>
        <option value="early">遅れている</option>
      </select>
    </div>

    <div style="margin: 12px 0;">
      <button class="action-btn toggle-btn" onclick="toggleReverseMode()" tabindex="18">⇆変換</button>
    </div>

    <div id="reverseTimeBlock" class="input-group">
      <label id="reverseTimeLabel" for="reverseDisplayTime">表示時刻:</label><br>
      <input type="datetime-local" id="reverseDisplayTime" step="60" tabindex="19">
      <select id="reverseDisplaySeconds" class="seconds-select" tabindex="20">
        <option value="">--</option>
      </select>
    </div>

    <div id="reverseResult" class="result-box"></div>
    <button class="action-btn" id="addToListButton" onclick="addResultToList()" style="display:none;">一覧に追加</button>
    <p id="showListLink" class="show-list-link" onclick="showResultList()" style="display:none;">結果一覧を表示 →</p>
  </div>

  <!-- 📋 結果一覧ページ -->
  <div id="resultListPage" style="display:none; text-align:center; padding: 40px 16px;"><br><br>
    <button class="back-btn" onclick="backToCorrectionMode()">← 補正時刻の計算に戻る</button>
    <h1 class="fkz" style="margin-top: 40px;">結果一覧</h1>
    <div id="resultListContainer" style="margin-top: 30px;"></div>
  </div>

  <!-- 🧾 Information Center -->
  
  <script src="https://cdn.jsdelivr.net/npm/qrcode/build/qrcode.min.js"></script>
  
  <div id="informationPage" style="display:none; text-align:center; padding: 40px 16px;"><br>
    <button class="back-btn" onclick="backToLockScreen()">← 初期画面に戻る</button>
    <h1 class="fkz" style="margin-top: 40px;">Information</h1>
    <div id="informationContent" style="margin-top: 30px; text-align: left; max-width: 500px; margin-left: auto; margin-right: auto;">
      <p>https://fkz1977.github.io/Time-Regulus/</p>
      <p>このアプリは <strong>H.Fukazu</strong> によって制作されました。バージョン: <strong>v1.5.1</strong></p><br>

      <h3 style="margin-top:24px;">## 著作権および利用規約 (Copyright and Usage Policy)</h3>
      <p>本作品（ソフトウェア、コード、ドキュメント、および関連する全ての内容を含む）の著作権は、© 2025 H.Fukazu に帰属します。<br>**© 2025 H.Fukazu. All Rights Reserved.**</p><br>
      <h3 style="margin-top:24px;"> 厳禁事項 (Strictly Prohibited)</h3>
      <p>著作者からの書面による事前の明示的な許可なく、以下の行為を固く禁じます。</p>
      <ul>
        <li>無断転用、複製、改変、二次利用は禁止</li>
        <li>ソースコードの全部または一部の無断転載および再配布の禁止</li>
        <li>商業的な目的での利用禁止 (営利・非営利を問わず、対価を得る活動への利用)</li>
        <li>本作品を基にした派生作品の作成および公開も禁止</li>
      </ul>
      <p>本作品は、著作権法によって最大限に保護されています。上記の禁止事項に違反した場合、法的な措置を講じる可能性があります。</p>
    </div>
    
    <!-- QRコード表示領域 -->
<div id="qrcode" style="text-align: center; margin-top: 20px;"></div>

    </div>

  <script src="script.js" defer></script>
  <script>
    if ("serviceWorker" in navigator) {
      navigator.serviceWorker.register("service-worker.js")
        .then(() => console.log("Service Worker registered"))
        .catch(error => console.error("Service Worker registration failed:", error));
    }
  </script>
</body>
</html>